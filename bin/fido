#!/usr/bin/env node

var program = require('commander');
var config = require('./../configuration');
var iTunesReviews = require('./../lib/review');
var reviews = new iTunesReviews();
var FormatPodcastReview = require('./../lib/format');
var formater = new FormatPodcastReview();
var clc = require('cli-color');


program
  .version('0.0.1')
  .option('-p, --pages', 'The number of pages to fetch (default: 1)', 1)
  .parse(process.argv);

var page = program.pages;

console.log(clc.green('\niTunes-Podcast-Reviews\n2015 (c) Reactivists (https://github.com/orgs/reactivepod/teams/reactivists)\nMIT\n'));

config.forEach(function(cfg) {
  reviews.get(cfg.countries, page, cfg.podcastId, function(error, data) {
    console.log(clc.bold.black('** ' + cfg.name + ' **'));
    console.log(formater.execute(data));
  });
});
